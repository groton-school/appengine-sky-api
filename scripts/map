#!/usr/bin/env php
<?php

use Battis\DataUtilities\Path;
use Battis\OpenAPI\CLI\Map;
use cebe\openapi\spec\OpenApi;
use Monolog\Handler\ErrorLogHandler;
use Monolog\Logger;
use pahanini\Monolog\Formatter\CliFormatter;

require __DIR__ . "/../vendor/autoload.php";

class BlackbaudMap extends Map {
  protected function getNamespaceFromSpec(string $specPath, OpenApi $spec, string $baseNamespace): string
  {
    return Path::join("\\",[$baseNamespace,  $spec->info->title]);
  }
  
  protected function getBasePathFromSpec(string $specPath, OpenApi $spec, string $basePath): string
  {
    return Path::join($basePath,  $spec->info->title);  
  }
}

$logger = new Logger('console');
$handler = new ErrorLogHandler();
$handler->setFormatter(new CliFormatter());
$logger->pushHandler($handler);

$map = new BlackbaudMap($logger);
$map->run();